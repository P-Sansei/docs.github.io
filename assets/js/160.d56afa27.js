(window.webpackJsonp=window.webpackJsonp||[]).push([[160],{375:function(s,a,e){"use strict";e.r(a);var n=e(2),t=Object(n.a)({},function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"kubernetes-第一个容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-第一个容器","aria-hidden":"true"}},[s._v("#")]),s._v(" Kubernetes 第一个容器")]),s._v(" "),e("h2",{attrs:{id:"检查组件运行状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检查组件运行状态","aria-hidden":"true"}},[s._v("#")]),s._v(" 检查组件运行状态")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get cs\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nNAME                 STATUS    MESSAGE             ERROR\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调度服务，主要作用是将 POD 调度到 Node")]),s._v("\nscheduler            Healthy   ok\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自动化修复服务，主要作用是 Node 宕机后自动修复 Node 回到正常的工作状态")]),s._v("\ncontroller-manager   Healthy   ok\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务注册与发现")]),s._v("\netcd-0               Healthy   "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"health"')]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h2",{attrs:{id:"检查-master-状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检查-master-状态","aria-hidden":"true"}},[s._v("#")]),s._v(" 检查 Master 状态")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl cluster-info\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nKubernetes master is running at https://192.168.141.110:6443\nKubeDNS is running at https://192.168.141.110:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\nTo further debug and diagnose cluster problems, use "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl cluster-info dump'")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v(".")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"检查-nodes-状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检查-nodes-状态","aria-hidden":"true"}},[s._v("#")]),s._v(" 检查 Nodes 状态")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get nodes\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nNAME                 STATUS   ROLES    AGE   VERSION\nkubernetes-master    Ready    master   72m   v1.15.0\nkubernetes-node-01   Ready    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   52m   v1.15.0\nkubernetes-node-02   Ready    "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   51m   v1.15.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h2",{attrs:{id:"运行第一个容器实例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行第一个容器实例","aria-hidden":"true"}},[s._v("#")]),s._v(" 运行第一个容器实例")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 kubectl 命令创建两个监听 80 端口的 Nginx Pod（Kubernetes 运行容器的最小单元）")]),s._v("\nkubectl run nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("2 --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("80\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nkubectl run --generator"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("deployment/apps.v1 is DEPRECATED and will be removed "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a future version. Use kubectl run --generator"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("run-pod/v1 or kubectl create instead.\ndeployment.apps/nginx created\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"查看全部-pods-的状态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看全部-pods-的状态","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看全部 Pods 的状态")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get pods\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nNAME                     READY   STATUS    RESTARTS   AGE\nnginx-7c45b84548-mv8n8   1/1     Running   0          36s\nnginx-7c45b84548-vp2x6   1/1     Running   0          36s\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"查看已部署的服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看已部署的服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看已部署的服务")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get deployment\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nNAME    READY   UP-TO-DATE   AVAILABLE   AGE\nnginx   2/2     2            2           70s\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"发布服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#发布服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 发布服务")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用负载均衡模式发布服务，让用户可以访问")]),s._v("\nkubectl expose deployment nginx --port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("80 --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("LoadBalancer\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nservice/nginx exposed\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"查看已发布的服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看已发布的服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看已发布的服务")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl get services\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nNAME         TYPE           CLUSTER-IP      EXTERNAL-IP   PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        AGE\nkubernetes   ClusterIP      10.96.0.1       "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        443/TCP        81m\nnginx        LoadBalancer   10.102.37.240   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pending"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     80:31406/TCP   115s\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h2",{attrs:{id:"查看服务详情"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看服务详情","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看服务详情")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl describe "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\nName:                     nginx\nNamespace:                default\nLabels:                   run"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\nAnnotations:              "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nSelector:                 run"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx\nType:                     LoadBalancer\nIP:                       10.102.37.240\nPort:                     "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unset"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  80/TCP\nTargetPort:               80/TCP\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布到外网的服务端口")]),s._v("\nNodePort:                 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("unset"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  31406/TCP\nEndpoints:                192.168.140.66:80,192.168.141.194:80\nSession Affinity:         None\nExternal Traffic Policy:  Cluster\nEvents:                   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("h2",{attrs:{id:"验证是否成功"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#验证是否成功","aria-hidden":"true"}},[s._v("#")]),s._v(" 验证是否成功")]),s._v(" "),e("p",[s._v("通过浏览器访问 Node 服务器，此时 Kubernetes 会以负载均衡的方式访问部署的 Nginx 服务，能够正常看到 Nginx 的欢迎页即表示成功")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("http://192.168.141.120:31406/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"停止服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#停止服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 停止服务")]),s._v(" "),e("ul",[e("li",[s._v("删除已部署的服务")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl delete deployment nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\ndeployment.extensions "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(" deleted\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("删除已发布的服务")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl delete "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出如下")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v(" deleted\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])},[],!1,null,null,null);a.default=t.exports}}]);